<div class="offers-container">
  <!-- Filtres par type d'offre -->
  <div class="filters">
    <h2>Filtrer par type</h2>
    <div class="filter-chips">
      <button mat-button
              [class.active]="selectedType === null"
              (click)="filterByType(null)">
        Tous
      </button>
      <button mat-button
              *ngFor="let type of offerTypes"
              [class.active]="selectedType === type"
              (click)="filterByType(type)">
        {{type}}
      </button>
    </div>
  </div>

  <!-- Liste des offres -->
  <div class="offers-list" *ngIf="(offers$ | async) as offers; else loading">
    <div *ngIf="offers.length > 0; else noOffers">
      <mat-card class="offer-card" *ngFor="let offer of offers">
        <mat-card-header>
          <mat-card-title>{{offer.name}}</mat-card-title>
          <mat-card-subtitle>{{offer.price | currency:'EUR'}}</mat-card-subtitle>
        </mat-card-header>
        <mat-card-content>
          <div class="offer-chips">
            <mat-chip>{{offer.offerType}}</mat-chip>
            <mat-chip>{{offer.personCount}} personne(s)</mat-chip>
            <mat-chip [color]="offer.available ? 'primary' : 'warn'">
              {{offer.available ? 'Disponible' : 'Non disponible'}}
            </mat-chip>
          </div>
          <p class="offer-description" *ngIf="offer.description">
            {{offer.description | slice:0:150}}{{offer.description.length > 150 ? '...' : ''}}
          </p>
        </mat-card-content>
        <mat-card-actions>
          <button mat-button color="primary" (click)="viewOfferDetails(offer)">
            <mat-icon>visibility</mat-icon> Voir détails
          </button>
          <button mat-raised-button color="accent" [disabled]="!offer.available" (click)="reserve(offer)">
            <mat-icon>calendar_today</mat-icon> Réserver
          </button>
        </mat-card-actions>
      </mat-card>
    </div>
  </div>

  <!-- Templates pour les états alternatifs -->
  <ng-template #loading>
    <div class="loading-container">
      <mat-spinner diameter="40"></mat-spinner>
      <p>Chargement des offres...</p>
    </div>
  </ng-template>

  <ng-template #noOffers>
    <div class="no-offers">
      <mat-icon>search_off</mat-icon>
      <p>Aucune offre trouvée pour ces critères.</p>
    </div>
  </ng-template>

  <!-- Affichage des erreurs -->
  <div *ngIf="error" class="error-container">
    <mat-card>
      <mat-card-content>
        <mat-icon color="warn">error</mat-icon>
        <p>{{error}}</p>
      </mat-card-content>
      <mat-card-actions>
        <button mat-button (click)="goBack()">Retour</button>
      </mat-card-actions>
    </mat-card>
  </div>
</div>
